// xgui.js r1 - https://github.com/oosmoxiecode/xgui.js
(function(){function f(h,e,m){var i=f.resolve(h);if(null==i)throw m=m||h,e=e||"root",i=Error('Failed to require "'+m+'" from "'+e+'"'),i.path=m,i.parent=e,i.require=!0,i;e=f.modules[i];e.exports||(e.exports={},e.client=e.component=!0,e.call(this,e.exports,f.relative(i),e));return e.exports}var s=Object.prototype.hasOwnProperty;f.modules={};f.aliases={};f.resolve=function(h){"/"===h.charAt(0)&&(h=h.slice(1));for(var e=h+"/index.js",m=[h,h+".js",h+".json",h+"/index.js",h+"/index.json"],i=0;i<m.length;i++)if(h=
m[i],s.call(f.modules,h))return h;if(s.call(f.aliases,e))return f.aliases[e]};f.normalize=function(h,e){var f=[];if("."!=e.charAt(0))return e;for(var h=h.split("/"),e=e.split("/"),i=0;i<e.length;++i)".."==e[i]?h.pop():"."!=e[i]&&""!=e[i]&&f.push(e[i]);return h.concat(f).join("/")};f.register=function(h,e){f.modules[h]=e};f.alias=function(h,e){if(!s.call(f.modules,h))throw Error('Failed to alias "'+h+'", it does not exist');f.aliases[e]=h};f.relative=function(h){function e(i){var q=e.resolve(i);return f(q,
h,i)}var m=f.normalize(h,"..");e.resolve=function(e){var q=e.charAt(0);if("/"==q)return e.slice(1);if("."==q)return f.normalize(m,e);var q=h.split("/"),r;a:{for(r=q.length;r--;)if("deps"===q[r])break a;r=-1}(r+=1)||(r=0);return e=q.slice(0,r+1).join("/")+"/deps/"+e};e.exists=function(h){return s.call(f.modules,e.resolve(h))};return e};f.register("xgui/index.js",function(h,e,f){f.exports=e("./src/xgui")});f.register("xgui/src/xgui.js",function(h,e,f){function i(e){var h=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/.exec(e);
return h?(16777216|h[1]<<16|h[2]<<8|h[3]).toString(16).substr(1):e}f.exports=function(e){function h(a,c){a.preventDefault();var b=a,d=1,e=0;c&&(d=a.touches.length);for(var g=0;g<d;g++){c&&(b=a.touches[g],e=b.identifier);if(!m[e]){if(null!=n[e]){var f=l[n[e]];if("ColorPicker2"==f.name){var i=o.relMouseCoords(b);f.mouseMove(i.x-f.x,i.y-f.y)}}break}i=o.relMouseCoords(b);f=l[n[e]];if("CheckBox"==f.name||"RadioButton"==f.name||"Button"==f.name||"ImageButton"==f.name||"Matrix"==f.name)break;if("Stepper"==
f.name&&(f.mouseDownPlus||f.mouseDownMinus))break;f.mouseDown(i.x-f.x,i.y-f.y)}}function f(a,c){var b=a,d=0;c&&(d=a.changedTouches[0].identifier);if(a.target==k||a.target==o)null!=n[d]?"InputText"!=l[n[d]].name&&"DropDown"!=l[n[d]].name&&a.preventDefault():a.preventDefault();c&&(b=a.touches[d]);for(var e=o.relMouseCoords(b),g=0;g<l.length;++g)if(b=l[g],e.x>b.x&&e.x<b.x+b.width&&e.y>b.y&&e.y<b.y+b.height){b.mouseDown(e.x-b.x,e.y-b.y);m[d]=!0;null!=n[d]&&(e=l[n[d]],"ColorPicker2"==e.name&&e.mouseUp());
n[d]=b.id;break}}function u(a,c){var b=0;c&&(b=a.changedTouches[0].identifier);m[b]=!1;null!=n[b]&&l[n[b]].mouseUp(b)}void 0==e&&(e={});var k,o,a,l=[],m=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],n=[null,null,null,null,null,null,null,null,null,null,null],g=e.backgroundColor||"rgb(100, 100, 100)",j=e.frontColor||"rgb(230, 230, 230)",p=e.dimColor||"rgb(140, 140, 140)",t;this.width=e.width||600;this.height=e.height||400;k=document.createElement("div");k.style.position="relative";k.style.width=""+this.width+
"px";k.style.height=""+this.height+"px";k.setAttribute("id","xgui_container");o=document.createElement("canvas");o.width=this.width;o.height=this.height;a=o.getContext("2d");k.appendChild(o);var s="ontouchstart"in o||null!=navigator.userAgent.match(/ipad|iphone|android/i);s?(document.addEventListener("touchmove",function(a){h(a,!0)},!1),k.addEventListener("touchstart",function(a){f(a,!0)},!1),document.addEventListener("touchend",function(a){u(a,!0)},!1)):(document.addEventListener("mousemove",function(a){h(a)},
!1),k.addEventListener("mousedown",function(a){f(a)},!1),document.addEventListener("mouseup",function(a){u(a)},!1));Base=function c(a){if(this.constructor!=c){a==void 0&&(a={});this.id=l.push(this)-1;this.x=a.x||0;this.y=a.y||0;this.updateInterval=a.updateInterval||200;this.lastUpdate=0}};Value=function(c){this.v=c;this.bindArray=[];this.both=this.receiver=false};Value.prototype.bind=function(){var c=arguments[0];if(typeof c=="function")this.bindArray.push(c);else if(typeof c=="object"){for(var c=
[c],a=1;a<arguments.length;++a)c.push(arguments[a]);this.bindArray.push(c)}else console.log("error")};Value.prototype.updateBind=function(c){for(var c=c||false,a=0;a<this.bindArray.length;++a){var d=this.bindArray[a];if(typeof d=="function")d(this.v,c);else if(typeof d=="object")for(var e=d[0],f=1;f<d.length;++f)if(this.receiver)this.v=e[d[f]];else{if(this.both)this.v=e[d[f]];e[d[f]]=this.v}else console.log("error")}};this.Matrix=function(c){Base.call(this,c);this.name="Matrix";this.w=c.w||4;this.h=
c.h||4;this.size=c.size||10;this.width=this.w*this.size+this.w-1;this.height=this.h*this.size+this.h-1;for(var a=[],d=0;d<this.h;++d){a[d]=[];for(var e=0;e<this.w;++e)a[d][e]=0}this.value=new Value(c.array||a);this.draw()};this.Matrix.prototype=new Base;this.Matrix.prototype.constructor=this.Matrix;this.Matrix.prototype.draw=function(){a.clearRect(this.x,this.y,this.width,this.height);for(var c=0;c<this.h;++c)for(var b=0;b<this.w;++b){a.fillStyle=g;a.fillRect(this.x+b*this.size+b,this.y+c*this.size+
c,this.size,this.size);if(this.value.v[c][b]){a.fillStyle=j;a.fillRect(this.x+b*this.size+b+2,this.y+c*this.size+c+2,this.size-4,this.size-4)}}};this.Matrix.prototype.mouseDown=function(c,a){var d=Math.floor(c/(this.size+1)),e=Math.floor(a/(this.size+1));this.value.v[e][d]=this.value.v[e][d]?0:1;this.value.updateBind();this.draw()};this.Matrix.prototype.mouseUp=function(){this.value.updateBind(true)};this.RangeSlider=function(a){Base.call(this,a);this.name="RangeSlider";this.mouseIsOver=false;this.value1=
new Value(a.value1||25);this.value2=new Value(a.value2||75);this.width=a.width||100;this.height=a.height||10;this.min=a.min||0;this.max=a.max||this.width;this.range=this.max-this.min;this.decimals=a.decimals||0;this.draw()};this.RangeSlider.prototype=new Base;this.RangeSlider.prototype.constructor=this.RangeSlider;this.RangeSlider.prototype.draw=function(){if(this.value1.v>this.max)this.value1.v=this.max;if(this.value1.v<this.min)this.value1.v=this.min;if(this.value2.v>this.max)this.value2.v=this.max;
if(this.value2.v<this.min)this.value2.v=this.min;if(this.value1.v>this.value2.v)this.value1.v=this.value2.v;if(this.value2.v<this.value1.v)this.value2.v=this.value1.v;a.clearRect(this.x,this.y,this.width,this.height);a.fillStyle=g;a.fillRect(this.x,this.y,this.width,this.height);var c=Math.round(Math.max(0,this.height-11)*0.5);a.fillStyle=j;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value1.v.toFixed(this.decimals),this.x,this.y+9+c);a.fillStyle=j;a.font="11px Arial";
a.textBaseline="alphabetic";a.textAlign="right";a.fillText(this.value2.v.toFixed(this.decimals),this.x+this.width-1,this.y+9+c);a.fillStyle=j;var b=this.getPositionFromValue(this.value1.v),d=this.getPositionFromValue(this.value2.v);a.fillRect(this.x+b,this.y,d-b,this.height);a.save();a.fillStyle="transparent";a.beginPath();a.rect(this.x+b,this.y,d-b,this.height);a.clip();a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value1.v.toFixed(this.decimals),
this.x,this.y+9+c);a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="right";a.fillText(this.value2.v.toFixed(this.decimals),this.x+this.width-1,this.y+9+c);a.restore()};this.RangeSlider.prototype.setValueFromPosition=function(a,b){var d=this.range/this.width*a-(this.range-this.max);if(d>this.max)d=this.max;if(d<this.min)d=this.min;b==1?this.value1.v=d:this.value2.v=d};this.RangeSlider.prototype.getPositionFromValue=function(a){var b=this.width/this.range,d=Math.abs(this.min);
this.min>0&&(d=d*-1);return b*(a+d)};this.RangeSlider.prototype.mouseDown=function(a){var b=this.getPositionFromValue(this.value1.v),d=this.getPositionFromValue(this.value2.v),b=Math.abs(a-b),d=Math.abs(a-d);if(b<d){this.setValueFromPosition(a,1);this.value1.updateBind()}else{this.setValueFromPosition(a,2);this.value2.updateBind()}this.draw()};this.RangeSlider.prototype.mouseUp=function(){this.value1.updateBind(true);this.value2.updateBind(true)};this.DropDown=function(a){Base.call(this,a);this.name=
"DropDown";this.values=a.values||["DropDown"];this.texts=a.texts||this.values;this.dropdown=document.createElement("select");this.dropdown.setAttribute("id",this.id);this.value=new Value(this.values[0]);for(a=0;a<this.values.length;++a){var b=document.createElement("option");b.text=this.texts[a];b.value=this.values[a];this.dropdown.options.add(b)}a=document.createElement("canvas");a.width=16;a.height=16;b=a.getContext("2d");b.clearRect(0,0,16,16);b.fillStyle=p;b.fillRect(0,0,16,16);b.fillStyle=j;
b.beginPath();b.moveTo(4.5,6);b.lineTo(12.5,6);b.lineTo(8.5,11);b.lineTo(4.5,6);b.closePath();b.fill();b.strokeStyle=g;b.beginPath();b.moveTo(0,0);b.lineTo(0,16);b.closePath();b.stroke();b.beginPath();b.moveTo(16,0);b.lineTo(16,16);b.closePath();b.stroke();this.div=document.createElement("div");this.div.setAttribute("id","input"+this.id);this.div.style.position="absolute";this.div.style.overflow="hidden";this.div.style.left=this.x-1+"px";this.div.style.top=this.y-1+"px";this.div.style.width="101px";
this.div.style.height="16px";this.div.style.background="url('"+a.toDataURL("image/png")+"') no-repeat right "+j+"";this.dropdown.style.position="absolute";this.dropdown.style.left="0px";this.dropdown.style.top="0px";this.dropdown.style.borderWidth="1px";this.dropdown.style.fontFamily="sans-serif";this.dropdown.style.fontSize="10px";this.dropdown.style.outlineStyle="none";this.dropdown.style.color=g;this.dropdown.style.webkitAppearance="none";this.dropdown.style.webkitBorderRadius="0px";this.dropdown.style.background=
"rgba(0,0,0,0)";this.dropdown.style.borderStyle="solid";this.dropdown.style.width="119px";this.dropdown.style.height="16px";this.dropdown.style.textIndent="0px";this.dropdown.style.borderLeftColor=g;this.dropdown.style.borderTopColor=g;this.dropdown.style.borderRightColor=g;this.dropdown.style.borderBottomColor=g;k.appendChild(this.div);this.div.appendChild(this.dropdown);this.dropdown.onchange=this.onChange;this.dropdown.onfocus=this.onFocus;this.draw()};this.DropDown.prototype=new Base;this.DropDown.prototype.constructor=
this.DropDown;this.DropDown.prototype.onChange=function(){var a=l[this.id];a.value.v=this.value;a.value.updateBind()};this.DropDown.prototype.onFocus=function(){};this.DropDown.prototype.draw=function(){};this.DropDown.prototype.mouseDown=function(){};this.DropDown.prototype.mouseUp=function(){};this.InputText=function(a){Base.call(this,a);this.name="InputText";this.text=a.text||"";this.input=document.createElement("input");this.value=new Value(this.text);this.input.value=this.value.v;this.input.type=
"text";this.input.setAttribute("id",this.id);this.input.style.position="absolute";this.input.style.left=this.x-1+"px";this.input.style.top=this.y-1+"px";this.input.style.borderWidth="1px";this.input.style.fontFamily="sans-serif";this.input.style.fontSize="10px";this.input.style.outlineStyle="none";this.input.style.color=g;this.input.style.backgroundColor=j;this.input.style.borderStyle="solid";this.input.style.width="100px";this.input.style.height="12px";this.input.style.marginLeft="0px";this.input.style.textIndent=
"3px";this.input.style.borderLeftColor=g;this.input.style.borderTopColor=g;this.input.style.borderRightColor=g;this.input.style.borderBottomColor=g;this.input.oninput=this.onTextChange;this.input.onfocus=this.onFocus;k.appendChild(this.input);this.draw()};this.InputText.prototype=new Base;this.InputText.prototype.constructor=this.InputText;this.InputText.prototype.draw=function(){};this.InputText.prototype.onTextChange=function(){var a=l[this.id];a.value.v=this.value;a.value.updateBind()};this.InputText.prototype.onFocus=
function(){};this.InputText.prototype.mouseDown=function(){};this.InputText.prototype.mouseUp=function(){};this.Stepper=function(a){Base.call(this,a);this.name="Stepper";this.mouseIsOver=false;this.value=new Value(a.value||0);this.width=a.width||60;this.height=a.height||10;this.min=a.min||-1E4;this.max=a.max||1E4;this.mouseDownPlus=this.mouseDownMinus=this.mouseDownNumber=false;this.lastMouseY=this.lastMouseX=null;this.step=a.step||10;this.decimals=a.decimals||0;this.bx=this.width-22;this.draw()};
this.Stepper.prototype=new Base;this.Stepper.prototype.constructor=this.Stepper;this.Stepper.prototype.draw=function(){if(this.value.v<this.min)this.value.v=this.min;if(this.value.v>this.max)this.value.v=this.max;a.clearRect(this.x,this.y,this.width,this.height);a.fillStyle=g;a.fillRect(this.x,this.y,this.width,this.height);var c=Math.round(Math.max(0,this.height-11)*0.5);a.fillStyle=j;if(this.mouseDownMinus)a.fillStyle=g;a.fillRect(this.x+this.bx,this.y+1,10,this.height-2);a.fillStyle=g;if(this.mouseDownMinus)a.fillStyle=
j;a.fillRect(this.x+this.bx+2,this.y+4+c,6,2);a.fillStyle=j;if(this.mouseDownPlus)a.fillStyle=g;a.fillRect(this.x+this.bx+11,this.y+1,10,this.height-2);a.fillStyle=g;if(this.mouseDownPlus)a.fillStyle=j;a.fillRect(this.x+this.bx+13,this.y+4+c,6,2);a.fillRect(this.x+this.bx+15,this.y+2+c,2,6);a.fillStyle=j;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="center";a.fillText(this.value.v.toFixed(this.decimals),this.x+this.bx/2,this.y+9+c)};this.Stepper.prototype.mouseDown=function(a,b){if(a<
this.bx&&!this.mouseDownMinus&&!this.mouseDownPlus){this.mouseDownNumber=true;this.mouseDownPlus=this.mouseDownMinus=false}else if(a>=this.bx&&a<this.bx+11&&!this.mouseDownNumber&&!this.mouseDownPlus){this.mouseDownMinus=true;this.mouseDownPlus=this.mouseDownNumber=false;this.value.v=this.value.v-this.step}else if(a>=this.bx+11&&!this.mouseDownNumber&&!this.mouseDownMinus){this.mouseDownPlus=true;this.mouseDownMinus=this.mouseDownNumber=false;this.value.v=this.value.v+this.step}if(this.lastMouseX!=
null&&this.mouseDownNumber){this.value.v=this.value.v+(a-this.lastMouseX-(b-this.lastMouseY))*this.step;this.draw()}this.lastMouseX=a;this.lastMouseY=b;this.draw();this.value.updateBind()};this.Stepper.prototype.mouseUp=function(){this.mouseDownPlus=this.mouseDownMinus=this.mouseDownNumber=false;this.lastMouseY=this.lastMouseX=null;this.value.updateBind(true);this.draw()};this.Graph=function(a){Base.call(this,a);this.name="Graph";this.width=a.width||100;this.height=a.height||40;this.min=a.min||0;
this.max=a.max||1;this.range=this.max-this.min;this.value=new Value(this.min);this.draw()};this.Graph.prototype=new Base;this.Graph.prototype.constructor=this.Graph;this.Graph.prototype.draw=function(){if(this.value.v>this.max)this.value.v=this.max;if(this.value.v<this.min)this.value.v=this.min;var c=a.getImageData(this.x,this.y,this.width,this.height);a.clearRect(this.x,this.y,this.width,this.height);a.strokeStyle=g;a.lineWidth=2;a.strokeRect(this.x,this.y,this.width,this.height);a.fillStyle=j;a.fillRect(this.x,
this.y,this.width,this.height);a.save();a.fillStyle="transparent";a.beginPath();a.rect(this.x,this.y,this.width,this.height);a.clip();var b=document.createElement("canvas");b.width=this.width;b.height=this.height;b.getContext("2d").putImageData(c,0,0);a.drawImage(b,this.x-1,this.y);a.fillStyle=p;c=this.height/this.range*(this.value.v+Math.abs(this.min));a.fillRect(this.x+this.width-1,this.y+this.height-c,1,c);a.restore()};this.Graph.prototype.mouseDown=function(){};this.Graph.prototype.mouseUp=function(){};
this.ImageButton=function(a){Base.call(this,a);this.name="ImageButton";this.image=a.image||new Image;this.width=a.width||this.image.width;this.height=a.height||this.image.height;this.mouseIsDown=false;this.value=new Value(this.mouseIsDown);this.draw()};this.ImageButton.prototype=new Base;this.ImageButton.prototype.constructor=this.ImageButton;this.ImageButton.prototype.draw=function(){a.clearRect(this.x,this.y,this.width,this.height);a.globalAlpha=this.mouseIsDown?0.5:1;a.drawImage(this.image,this.x,
this.y,this.width,this.height);a.globalAlpha=1};this.ImageButton.prototype.mouseDown=function(){this.mouseIsDown=true;this.value.v=this.mouseIsDown;this.value.updateBind();this.draw()};this.ImageButton.prototype.mouseUp=function(){this.value.updateBind(true);this.mouseIsDown=false;this.value.v=this.mouseIsDown;this.value.updateBind();this.draw()};this.Button=function(a){Base.call(this,a);this.name="Button";this.width=this.fullWidth=0;this.height=Math.max(a.height,14)||14;this.text=a.text||"";this.mouseIsDown=
false;this.value=new Value(this.mouseIsDown);this.draw();this.draw()};this.Button.prototype=new Base;this.Button.prototype.constructor=this.Button;this.Button.prototype.draw=function(){a.clearRect(this.x,this.y,this.width,this.height);a.strokeStyle=g;a.lineWidth=2;a.strokeRect(this.x,this.y,this.width,this.height);a.fillStyle=j;if(this.mouseIsDown)a.fillStyle=p;a.fillRect(this.x,this.y,this.width,this.height);var c=Math.round(Math.max(0,this.height-14)*0.5);a.fillStyle=g;if(this.mouseIsDown)a.fillStyle=
j;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.text,this.x+4,this.y+11+c);this.width=this.fullWidth+a.measureText(this.text).width+9};this.Button.prototype.mouseDown=function(){this.mouseIsDown=true;this.value.v=this.mouseIsDown;this.value.updateBind();this.draw()};this.Button.prototype.mouseUp=function(){this.value.updateBind(true);this.mouseIsDown=false;this.value.v=this.mouseIsDown;this.draw()};this.TrackPad=function(a){Base.call(this,a);this.name="TrackPad";
this.width=a.width||100;this.height=a.height||60;this.min=a.min||-1;this.max=a.max||1;this.size=a.size||6;this.range=this.max-this.min;var b=(this.range/2-this.max)*-1;this.value1=new Value(a.value1||b);this.value2=new Value(a.value2||b);this.draw()};this.TrackPad.prototype=new Base;this.TrackPad.prototype.constructor=this.TrackPad;this.TrackPad.prototype.draw=function(){if(this.value1.v<this.min)this.value1.v=this.min;if(this.value1.v>this.max)this.value1.v=this.max;if(this.value2.v<this.min)this.value2.v=
this.min;if(this.value2.v>this.max)this.value2.v=this.max;a.clearRect(this.x-1,this.y,this.width,this.height+14);a.strokeStyle=g;a.lineWidth=2;a.strokeRect(this.x,this.y,this.width,this.height);a.fillStyle=j;a.fillRect(this.x,this.y,this.width,this.height);a.strokeStyle=p;a.lineWidth=1;a.beginPath();a.moveTo(this.x,0.5+this.y+this.height/2);a.lineTo(this.x+this.width,0.5+this.y+this.height/2);a.closePath();a.stroke();a.beginPath();a.moveTo(0.5+this.x+this.width/2,this.y);a.lineTo(0.5+this.x+this.width/
2,this.y+this.height);a.closePath();a.stroke();var c=this.getXPositionFromValue(),b=this.getYPositionFromValue(),d=this.size/2;c<d&&(c=d);c>this.width-d&&(c=this.width-d);b<d&&(b=d);b>this.height-d&&(b=this.height-d);a.fillStyle=p;a.fillRect(this.x+c-d,this.y+b-d,this.size,this.size);a.fillStyle=g;a.font="8px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("X: "+this.value1.v.toFixed(2)+" Y: "+this.value2.v.toFixed(2),this.x,this.y+this.height+9)};this.TrackPad.prototype.setXValueFromPosition=
function(a){this.value1.v=this.range/this.width*a-(this.range-this.max)};this.TrackPad.prototype.setYValueFromPosition=function(a){this.value2.v=this.range/this.height*a-(this.range-this.max)};this.TrackPad.prototype.getXPositionFromValue=function(){var a=this.width/this.range,b=Math.abs(this.min);this.min>0&&(b=b*-1);return a*(this.value1.v+b)};this.TrackPad.prototype.getYPositionFromValue=function(){var a=this.height/this.range,b=Math.abs(this.min);this.min>0&&(b=b*-1);return a*(this.value2.v+b)};
this.TrackPad.prototype.mouseDown=function(a,b){this.setXValueFromPosition(a);this.setYValueFromPosition(b);this.draw();this.value1.updateBind();this.value2.updateBind()};this.TrackPad.prototype.mouseUp=function(){this.value1.updateBind(true);this.value2.updateBind(true)};this.ColorPicker2=function(a){Base.call(this,a);this.name="ColorPicker2";this.framewidth=a.framewidth||10;this.frameheight=a.frameheight||10;this.colorwidth=a.width||100;this.colorheight=a.height||30;this.width=this.framewidth;this.height=
this.frameheight;this.r=a.r||255;this.g=a.g||255;this.b=a.b||255;this.oldColor={r:this.r,g:this.g,b:this.b};this.mousehack=this.open=false;this.lastTime=0;this.hex=a.hex||i("rgb("+this.r+","+this.g+","+this.b+")");this.value=new Value(this.hex);this.draw()};this.ColorPicker2.prototype=new Base;this.ColorPicker2.prototype.constructor=this.ColorPicker2;this.ColorPicker2.prototype.draw=function(){a.clearRect(this.x-1,this.y-1,this.framewidth+60,this.height+3);a.clearRect(this.x-1,this.y+this.frameheight,
this.colorwidth+2,this.colorheight+3);a.strokeStyle=g;a.lineWidth=2;a.strokeRect(this.x,this.y,this.framewidth,this.frameheight);a.fillStyle="#"+this.value.v;a.fillRect(this.x,this.y,this.framewidth,this.frameheight);var c=Math.round(Math.max(0,this.frameheight-11)*0.5);a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("#"+this.value.v.toUpperCase(),this.x+this.framewidth+4,this.y+9+c);if(this.open){a.strokeStyle=g;a.lineWidth=2;a.strokeRect(this.x,this.y+
this.frameheight+1,this.colorwidth,this.colorheight);var c=a.createLinearGradient(this.x,this.y+this.frameheight+1,this.x+this.colorwidth,this.y+this.frameheight+1),b=1/6,d=0;c.addColorStop(b*d++,"rgb(255, 0, 0)");c.addColorStop(b*d++,"rgb(255, 255, 0)");c.addColorStop(b*d++,"rgb(0, 255, 0)");c.addColorStop(b*d++,"rgb(0, 255, 255)");c.addColorStop(b*d++,"rgb(0, 0, 255)");c.addColorStop(b*d++,"rgb(255, 0, 255)");c.addColorStop(b*d++,"rgb(255, 0, 0)");a.fillStyle=c;a.fillRect(this.x,this.y+this.frameheight+
1,this.colorwidth,this.colorheight);b=1/(this.colorheight/2);c=a.createLinearGradient(this.x,this.y+this.frameheight+1,this.x,this.y+this.frameheight+1+this.colorheight/2);c.addColorStop(0,"rgba(255, 255, 255, 1)");c.addColorStop(b,"rgba(255, 255, 255, 1)");c.addColorStop(1,"rgba(255, 255, 255, 0)");a.fillStyle=c;a.fillRect(this.x,this.y+this.frameheight+1,this.colorwidth,this.colorheight/2);c=a.createLinearGradient(this.x,this.y+this.frameheight+1+this.colorheight/2,this.x,this.y+this.frameheight+
1+this.colorheight);c.addColorStop(0,"rgba(0, 0, 0, 0)");c.addColorStop(1-b,"rgba(0, 0, 0, 1)");c.addColorStop(1,"rgba(0, 0, 0, 1)");a.fillStyle=c;a.fillRect(this.x,this.y+this.frameheight+1+this.colorheight/2,this.colorwidth,this.colorheight/2)}};this.ColorPicker2.prototype.mouseDown=function(a,b){if(!((new Date).getTime()-this.lastTime<200)){if(this.open&&a>0&&a<this.colorwidth-1&&b>this.frameheight&&b<this.frameheight+this.colorheight){s&&this.mouseMove(a,b);this.oldColor={r:this.r,g:this.g,b:this.b}}if(!this.open&&
b<this.frameheight)this.open=true;else if(this.open)this.open=false;if(this.open){this.width=this.colorwidth;this.height=this.frameheight+this.colorheight}else{this.width=this.framewidth;this.height=this.frameheight}this.draw();this.mousehack=false;this.lastTime=(new Date).getTime();if(!this.open)for(var d=0;d<l.length;++d)l[d].draw()}};this.ColorPicker2.prototype.setOldColor=function(){this.r=this.oldColor.r;this.g=this.oldColor.g;this.b=this.oldColor.b;this.hex=i("rgb("+this.r+","+this.g+","+this.b+
")")};this.ColorPicker2.prototype.mouseMove=function(c,b){var d=false;if(c<0){c=0;this.setOldColor();d=true}if(c>this.colorwidth-1){c=this.colorwidth-1;this.setOldColor();d=true}if(b<=this.frameheight){b=this.frameheight;this.setOldColor();d=true}if(b>this.frameheight+this.colorheight){b=this.frameheight+this.colorheight;this.setOldColor();d=true}if(!d){d=a.getImageData(this.x+c,this.y+b,1,1).data;this.r=d[0];this.g=d[1];this.b=d[2];this.hex=i("rgb("+this.r+","+this.g+","+this.b+")")}this.value.v=
this.hex;this.value.updateBind();this.draw()};this.ColorPicker2.prototype.mouseUp=function(a){this.open||(n[a]=null);if(this.mousehack){this.setOldColor();this.mouseDown();n[a]=null}this.mousehack=true;this.value.updateBind(true)};this.ColorPicker=function(a){Base.call(this,a);this.name="ColorPicker";this.framewidth=a.framewidth||10;this.frameheight=a.frameheight||10;this.width=a.width||100;this.height=a.height||20;this.r=a.r||255;this.g=a.g||255;this.b=a.b||255;this.hex=a.hex||i("rgb("+this.r+","+
this.g+","+this.b+")");this.value=new Value(this.hex);this.draw()};this.ColorPicker.prototype=new Base;this.ColorPicker.prototype.constructor=this.ColorPicker;this.ColorPicker.prototype.draw=function(){a.clearRect(this.x,this.y,this.width,this.height+this.frameheight+4);a.strokeStyle=g;a.lineWidth=2;a.strokeRect(this.x,this.y,this.width,this.height);var c=a.createLinearGradient(this.x,this.y,this.x+this.width,this.y),b=1/6,d=0;c.addColorStop(b*d++,"rgb(255, 0, 0)");c.addColorStop(b*d++,"rgb(255, 255, 0)");
c.addColorStop(b*d++,"rgb(0, 255, 0)");c.addColorStop(b*d++,"rgb(0, 255, 255)");c.addColorStop(b*d++,"rgb(0, 0, 255)");c.addColorStop(b*d++,"rgb(255, 0, 255)");c.addColorStop(b*d++,"rgb(255, 0, 0)");a.fillStyle=c;a.fillRect(this.x,this.y,this.width,this.height);b=1/(this.height/2);c=a.createLinearGradient(this.x,this.y,this.x,this.y+this.height/2);c.addColorStop(0,"rgba(255, 255, 255, 1)");c.addColorStop(b,"rgba(255, 255, 255, 1)");c.addColorStop(1,"rgba(255, 255, 255, 0)");a.fillStyle=c;a.fillRect(this.x,
this.y,this.width,this.height/2);c=a.createLinearGradient(this.x,this.y+this.height/2,this.x,this.y+this.height);c.addColorStop(0,"rgba(0, 0, 0, 0)");c.addColorStop(1-b,"rgba(0, 0, 0, 1)");c.addColorStop(1,"rgba(0, 0, 0, 1)");a.fillStyle=c;a.fillRect(this.x,this.y+this.height/2,this.width,this.height/2);a.strokeStyle=g;a.lineWidth=2;a.strokeRect(this.x,this.y+this.height+4,this.framewidth,this.frameheight);a.fillStyle="#"+this.value.v;a.fillRect(this.x,this.y+this.height+4,this.framewidth,this.frameheight);
c=Math.round(Math.max(0,this.frameheight-10)*0.5);a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("#"+this.value.v.toUpperCase(),this.x+this.framewidth+4,this.y+this.height+13+c)};this.ColorPicker.prototype.mouseDown=function(c,b){c<0&&(c=0);c>this.width-1&&(c=this.width-1);b<0&&(b=0);b>this.height-1&&(b=this.height-1);var d=a.getImageData(this.x+c,this.y+b,1,1).data;this.r=d[0];this.g=d[1];this.b=d[2];this.hex=i("rgb("+this.r+","+this.g+","+this.b+")");
this.value.v=this.hex;this.value.updateBind();this.draw()};this.ColorPicker.prototype.mouseUp=function(){this.value.updateBind(true)};this.Knob=function(a){Base.call(this,a);this.name="Knob";this.radius=a.radius||15;this.centerx=this.x+this.radius;this.centery=this.y+this.radius;this.width=this.radius*2;this.height=this.radius*2;this.min=a.min||0;this.max=a.max||100;this.range=this.max-this.min;this.value=new Value(a.value||0);this.rotationValue=this.getRotationValue();this.lastMouseY=this.lastMouseX=
null;this.decimals=a.decimals||0;this.draw()};this.Knob.prototype=new Base;this.Knob.prototype.constructor=this.Knob;this.Knob.prototype.getRotationValue=function(){return(this.value.v-this.min)*(1/this.range)};this.Knob.prototype.draw=function(){if(this.value.v<this.min)this.value.v=this.min;if(this.value.v>this.max)this.value.v=this.max;a.clearRect(this.x-4,this.y-4,this.width+8,this.height+13);a.fillStyle=g;a.beginPath();a.arc(this.centerx,this.centery,this.radius,0,Math.PI*2,false);a.closePath();
a.fill();var c=Math.PI+Math.PI/1.25,b=Math.PI-Math.PI/1.25,d=(c-b)/this.radius;a.strokeStyle=g;a.lineWidth=0.5;for(var e=0;e<=this.radius;++e){var f=this.centerx+Math.sin(c-d*e)*(this.radius+1),h=this.centery+Math.cos(c-d*e)*(this.radius+1),i=this.centerx+Math.sin(c-d*e)*(this.radius+4),k=this.centery+Math.cos(c-d*e)*(this.radius+4);a.beginPath();a.moveTo(f,h);a.lineTo(i,k);a.closePath();a.stroke()}this.rotationValue=this.getRotationValue();d=(c-b)*this.rotationValue;b=this.centerx+Math.sin(c-d)*
this.radius;c=this.centery+Math.cos(c-d)*this.radius;a.strokeStyle=j;a.lineWidth=2;a.beginPath();a.moveTo(this.centerx,this.centery);a.lineTo(b,c);a.closePath();a.stroke();a.fillStyle=g;a.font="8px Arial";a.textBaseline="alphabetic";a.textAlign="center";a.fillText(this.value.v.toFixed(this.decimals),this.centerx,this.centery+this.radius+7)};this.Knob.prototype.mouseDown=function(a,b){if(this.lastMouseX!=null){var d=(a-this.lastMouseX-(b-this.lastMouseY))/100,d=d*this.range;this.value.v=this.value.v+
d;this.draw();this.value.updateBind()}this.lastMouseX=a;this.lastMouseY=b};this.Knob.prototype.mouseUp=function(){this.lastMouseY=this.lastMouseX=null;this.value.updateBind(true)};this.CheckBox=function(a){Base.call(this,a);this.name="CheckBox";this.text=a.text||"";this.value=new Value(a.selected||false);this.width=this.fullWidth=a.width||10;this.height=a.height||10;this.draw()};this.CheckBox.prototype=new Base;this.CheckBox.prototype.constructor=this.CheckBox;this.CheckBox.prototype.draw=function(){a.clearRect(this.x,
this.y,this.width,this.height);a.fillStyle=g;a.fillRect(this.x,this.y,this.fullWidth,this.height);a.fillStyle=this.value.v?j:g;a.fillRect(this.x+2,this.y+2,this.fullWidth-4,this.height-4);var c=Math.round(Math.max(0,this.height-11)*0.5);a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.text,this.x+this.fullWidth+2,this.y+9+c);this.width=this.fullWidth+a.measureText(this.text).width+3};this.CheckBox.prototype.mouseDown=function(){this.value.v=this.value.v?
false:true;this.value.updateBind();this.draw()};this.CheckBox.prototype.mouseUp=function(){this.value.updateBind(true)};this.RadioButtonGroup=function(){this.name="RadioButtonGroup";this.array=[];this.value=new Value([])};this.RadioButtonGroup.prototype.add=function(a){this.array.push(a);this.value.v.push(a.value.v);a.group=this};this.RadioButtonGroup.prototype.clear=function(a){for(var b=0;b<this.array.length;++b){var d=this.array[b];if(d==a)this.value.v[b]=true;else{this.value.v[b]=false;d.value.v=
false;d.value.updateBind();d.draw()}}this.value.updateBind()};this.RadioButton=function(a){Base.call(this,a);this.name="RadioButton";this.group=null;this.text=a.text||"";this.value=new Value(a.selected||false);this.width=this.fullWidth=a.width||18;this.height=a.height||10;this.draw()};this.RadioButton.prototype=new Base;this.RadioButton.prototype.constructor=this.RadioButton;this.RadioButton.prototype.draw=function(){a.clearRect(this.x,this.y,this.width,this.height);a.fillStyle=g;a.fillRect(this.x,
this.y,this.fullWidth,this.height);if(this.value.v){a.fillStyle=j;a.fillRect(this.x+this.fullWidth/2+1,this.y+2,this.fullWidth/2-3,this.height-4)}else{a.fillStyle=p;a.fillRect(this.x+2,this.y+2,this.fullWidth/2-3,this.height-4)}var c=Math.round(Math.max(0,this.height-11)*0.5);a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.text,this.x+this.fullWidth+2,this.y+9+c);this.width=this.fullWidth+a.measureText(this.text).width+3};this.RadioButton.prototype.mouseDown=
function(){this.group.clear(this);if(!this.value.v)this.value.v=true;this.value.updateBind();this.draw()};this.RadioButton.prototype.mouseUp=function(){this.value.updateBind(true)};this.RadioButton.prototype.mouseMove=function(){};this.HSlider=function(a){Base.call(this,a);this.name="HSlider";this.mouseIsOver=false;this.value=new Value(a.value||0);this.width=a.width||100;this.height=a.height||10;this.min=a.min||0;this.max=a.max||this.width;this.range=this.max-this.min;this.decimals=a.decimals||0;
this.draw()};this.HSlider.prototype=new Base;this.HSlider.prototype.constructor=this.HSlider;this.HSlider.prototype.draw=function(){if(this.value.v>this.max)this.value.v=this.max;if(this.value.v<this.min)this.value.v=this.min;a.clearRect(this.x,this.y,this.width,this.height);a.fillStyle=g;a.fillRect(this.x,this.y,this.width,this.height);var c=Math.round(Math.max(0,this.height-11)*0.5);a.fillStyle=j;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),
this.x,this.y+9+c);var b=this.getPositionFromValue();a.fillStyle=j;a.fillRect(this.x,this.y,b,this.height);a.save();a.fillStyle="transparent";a.beginPath();a.rect(this.x,this.y,b,this.height);a.clip();a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),this.x,this.y+9+c);a.restore()};this.HSlider.prototype.setValueFromPosition=function(a){this.value.v=this.range/this.width*a-(this.range-this.max)};this.HSlider.prototype.getPositionFromValue=
function(){var a=this.width/this.range,b=Math.abs(this.min);this.min>0&&(b=b*-1);return a*(this.value.v+b)};this.HSlider.prototype.mouseDown=function(a){this.setValueFromPosition(a);this.draw();this.value.updateBind()};this.HSlider.prototype.mouseUp=function(){this.value.updateBind(true)};this.VSlider=function(a){Base.call(this,a);this.name="VSlider";this.mouseIsOver=false;this.value=new Value(a.value||0);this.width=a.width||10;this.height=a.height||100;this.min=a.min||0;this.max=a.max||this.height;
this.decimals=a.decimals||0;this.range=this.max-this.min;this.draw()};this.VSlider.prototype=new Base;this.VSlider.prototype.constructor=this.VSlider;this.VSlider.prototype.draw=function(){if(this.value.v>this.max)this.value.v=this.max;if(this.value.v<this.min)this.value.v=this.min;a.clearRect(this.x,this.y,this.width,this.height);a.fillStyle=g;a.fillRect(this.x,this.y,this.width,this.height);var c=Math.round(Math.max(0,this.width-11)*0.5);a.save();a.translate(this.x+9+c,this.y+this.height-1);a.rotate(-Math.PI/
2);a.fillStyle=j;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),0,0);a.restore();var b=this.getPositionFromValue();a.fillStyle=j;a.fillRect(this.x,this.y+b,this.width,this.height-b);a.save();a.translate(this.x+9+c,this.y+this.height-1);a.rotate(-Math.PI/2);a.fillStyle="transparent";a.beginPath();a.rect(-1,-this.width+1,this.height-b,this.width);a.clip();a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";
a.fillText(this.value.v.toFixed(this.decimals),0,0);a.restore()};this.VSlider.prototype.setValueFromPosition=function(a){this.value.v=this.range-this.range/this.height*a-(this.range-this.max)};this.VSlider.prototype.getPositionFromValue=function(){var a=this.height/this.range,b=Math.abs(this.min);this.min>0&&(b=b*-1);return this.height-a*(this.value.v+b)};this.VSlider.prototype.mouseDown=function(a,b){this.setValueFromPosition(b);this.draw();this.value.updateBind()};this.VSlider.prototype.mouseUp=
function(){this.value.updateBind(true)};this.Joystick=function(a){Base.call(this,a);this.name="Joystick";this.value1=new Value(0);this.value2=new Value(0);this.radius=a.radius||50;this.innerRadius=a.innerRadius||this.radius*0.65;this.centerx=this.x+this.radius;this.centery=this.y+this.radius;this.width=this.radius*2;this.height=this.radius*2;this.sticky=this.stickx=0;this.laststicky=this.laststickx=-1;this.maxDistance=this.radius-this.innerRadius-5;this.mouseIsDown=false;this.draw()};this.Joystick.prototype=
new Base;this.Joystick.prototype.constructor=this.Joystick;this.Joystick.prototype.draw=function(c){if(!this.mouseIsDown){this.stickx=this.stickx+(0-this.stickx)/3;this.sticky=this.sticky+(0-this.sticky)/3}if(!(this.stickx.toFixed(2)==this.laststickx.toFixed(2)&&this.sticky.toFixed(2)==this.laststicky.toFixed(2)&&c)){this.value1.v=this.stickx/this.maxDistance;this.value2.v=this.sticky/this.maxDistance;a.clearRect(this.x-2,this.y-2,this.width+14,this.height+14);c=a.createRadialGradient(this.centerx,
this.centery,this.radius+5,this.centerx-7,this.centery-7,5);c.addColorStop(0,p);c.addColorStop(0.2,j);c.addColorStop(1,p);a.fillStyle=c;a.beginPath();a.arc(this.centerx,this.centery,this.radius,0,Math.PI*2,false);a.closePath();a.fill();var b=(1-this.value1.v)*5,d=(1-this.value2.v)*5,c=a.createRadialGradient(this.centerx+this.stickx+b,this.centery+this.sticky+d,this.innerRadius+10,this.centerx+this.stickx+b,this.centery+this.sticky+d,1);c.addColorStop(0,"rgba(0,0,0,0.00001)");c.addColorStop(1,"rgba(0,0,0,1)");
a.fillStyle=c;a.beginPath();a.arc(this.centerx+this.stickx+b,this.centery+this.sticky+d,this.innerRadius+10,0,Math.PI*2,false);a.closePath();a.fill();c=a.createLinearGradient(this.centerx+this.stickx-this.innerRadius,this.centery+this.sticky-this.innerRadius,this.centerx+this.stickx-this.innerRadius,this.centery+this.sticky+this.innerRadius);c.addColorStop(0,j);c.addColorStop(1,p);a.fillStyle=c;a.beginPath();a.arc(this.centerx+this.stickx,this.centery+this.sticky,this.innerRadius,0,Math.PI*2,false);
a.closePath();a.fill();c=a.createRadialGradient(this.centerx+this.stickx,this.centery+this.sticky,this.radius,this.centerx+this.stickx,this.centery+this.sticky,1);c.addColorStop(0,p);c.addColorStop(1,j);a.fillStyle=c;a.beginPath();a.arc(this.centerx+this.stickx,this.centery+this.sticky,this.innerRadius-6,0,Math.PI*2,false);a.closePath();a.fill();this.laststickx=this.stickx;this.laststicky=this.sticky}};this.Joystick.prototype.mouseDown=function(a,b){this.mouseIsDown=true;this.stickx=a-this.radius;
this.sticky=b-this.radius;if(Math.sqrt(this.stickx*this.stickx+this.sticky*this.sticky)>this.maxDistance){var d=Math.atan2(this.stickx,this.sticky);this.stickx=Math.sin(d)*this.maxDistance;this.sticky=Math.cos(d)*this.maxDistance}this.draw();this.value1.updateBind();this.value2.updateBind()};this.Joystick.prototype.mouseUp=function(){this.mouseIsDown=false;this.value1.updateBind(true);this.value2.updateBind(true)};this.Label=function(a){Base.call(this,a);this.name="Label";this.group=null;this.value=
new Value(a.text||"");this.width=0;this.height=13;this.draw()};this.Label.prototype=new Base;this.Label.prototype.constructor=this.Label;this.Label.prototype.draw=function(){a.clearRect(this.x,this.y,this.width,this.height);a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v,this.x,this.y+9);this.width=a.measureText(this.value.v).width+3};this.Label.prototype.mouseDown=function(){};this.Label.prototype.mouseUp=function(){};this.update=function(){t=
Date.now();for(var a=0;a<l.length;++a){var b=l[a];if(b.name=="Joystick")b.draw(true);else{if(b.value&&(b.value.receiver||b.value.both)&&t>b.lastUpdate+b.updateInterval){b.value.updateBind();b.draw();b.lastUpdate=t}if(b.value1){var d=false;if((b.value1.receiver||b.value1.both)&&t>b.lastUpdate+b.updateInterval){b.value1.updateBind();d=true}if((b.value2.receiver||b.value2.both)&&t>b.lastUpdate+b.updateInterval){b.value2.updateBind();d=true}if(d){b.draw();b.lastUpdate=t}}}}};return{getDomElement:function(){return k},
getContext:function(){return a},HSlider:this.HSlider,VSlider:this.VSlider,Label:this.Label,RadioButton:this.RadioButton,RadioButtonGroup:this.RadioButtonGroup,CheckBox:this.CheckBox,Knob:this.Knob,ColorPicker:this.ColorPicker,ColorPicker2:this.ColorPicker2,TrackPad:this.TrackPad,Button:this.Button,ImageButton:this.ImageButton,Graph:this.Graph,Stepper:this.Stepper,InputText:this.InputText,DropDown:this.DropDown,Matrix:this.Matrix,RangeSlider:this.RangeSlider,Joystick:this.Joystick,update:this.update}};
HTMLCanvasElement.prototype.relMouseCoords=function(e){var f=0,h=0,i=0,k=0,i=this;do f+=i.offsetLeft,h+=i.offsetTop;while(i=i.offsetParent);i=e.pageX-f;k=e.pageY-h;i=Math.round(i*(this.width/this.offsetWidth));k=Math.round(k*(this.height/this.offsetHeight));return{x:i,y:k}}});"object"==typeof exports?module.exports=f("xgui"):"function"==typeof define&&define.amd?define(function(){return f("xgui")}):window.xgui=f("xgui")})();
